<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tuscany 2025</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    img {
      max-width: 100%;
      height: auto;
    }
    .no-js .js-required {
      display: none;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .panel-content {
      display: none;
    }
    .panel-content.active {
      display: block;
    }
    .timeline-item {
      position: relative;
      padding-left: 2.5rem;
      margin-bottom: 1.5rem;
    }
    .timeline-item::before {
      content: '';
      position: absolute;
      left: 0.75rem;
      top: 0;
      bottom: 0;
      width: 4px;
      background: #3b82f6;
    }
    .timeline-dot {
      position: absolute;
      left: 0.5rem;
      top: 0.25rem;
      width: 16px;
      height: 16px;
      background: #3b82f6;
      border-radius: 50%;
    }
    .landing-bg {
      background-image: url('https://www.moravian.edu/sites/default/files/2023-04/Florence%20Header.png');
      background-size: 100% auto;
      background-position: center top;
      background-repeat: no-repeat;
      width: 100%;
      padding-bottom: 41.67%; /* 600/1440 aspect ratio to show full image height */
      position: relative; /* To contain absolutely positioned child */
      /* Fallback base64 gray */
      background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8DwHwAEhQGAdeS9bAAAAABJRU5ErkJggg==');
    }
    .landing-bg img.fallback {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      z-index: -1;
    }
    .centered-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      text-align: center;
      max-width: 90%; /* Prevent overflow on narrow screens */
      word-break: break-word; /* Ensure text wraps on small screens */
    }
    .centered-content h1 {
      font-size: 8vw; /* Responsive font size: 8% of viewport width */
      font-weight: 700;
      line-height: 1.2;
    }
    .centered-content #countdown {
      font-size: 5vw; /* Responsive font size: 5% of viewport width */
      margin-top: 1rem;
    }
    .nav-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      background-color: #1f2937;
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #landing-page.active ~ .nav-bar {
      display: none;
    }
    .nav-bar button {
      background-color: #3b82f6;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
    }
    .nav-bar button:hover {
      background-color: #2563eb;
    }
    .nav-bar select {
      background-color: #3b82f6;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      outline: none;
      width: 150px;
    }
    #bottom-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      background-color: #1f2937;
      color: white;
      text-align: center;
      padding: 0.5rem;
      font-size: 1rem;
      font-weight: 500;
    }
    .itinerary-tile {
      background-color: white;
      border-radius: 0.375rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 1rem;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .itinerary-tile:hover {
      transform: scale(1.02);
    }
    /* Modal Styles */
    #itinerary-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      overflow-y: auto;
    }
    #itinerary-modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 1.5rem;
      width: 90%;
      max-width: 800px;
      border-radius: 0.5rem;
      position: relative;
      max-height: 80vh;
      overflow-y: auto;
    }
    #modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background-color: #ef4444;
      color: white;
      border: none;
      border-radius: 0.25rem;
      padding: 0.5rem 1rem;
      cursor: pointer;
    }
    #modal-close:hover {
      background-color: #dc2626;
    }
    /* Ensure Landing Page content sits below the Navigation Bar */
    #landing-page {
      padding-top: 54px; /* Height of the nav-bar */
    }
    /* Game Styles */
    #game-canvas {
      border: 2px solid #4a5568;
      border-radius: 0.5rem;
      background-color: #f7fafc;
    }
    .game-button {
      background-color: #3b82f6;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      margin: 0.25rem;
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
    }
    .game-button:hover {
      background-color: #2563eb;
    }
    .game-button:disabled {
      background-color: #a0aec0;
      cursor: not-allowed;
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <!-- Navigation Bar -->
  <div class="nav-bar">
    <button id="home-btn">Home</button>
    <select id="nav-dropdown">
      <option value="landing">Home</option>
      <option value="itineraries">Itineraries</option>
      <option value="page1">Gelato Game</option>
      <option value="page2">Page 2</option>
      <option value="page3">Page 3</option>
    </select>
  </div>

  <!-- Modal for Itinerary Sections -->
  <div id="itinerary-modal">
    <div id="itinerary-modal-content">
      <button id="modal-close">Close</button>
      <div id="modal-content-body"></div>
    </div>
  </div>

  <!-- Landing Page -->
  <div id="landing-page" class="tab-content active">
    <div class="landing-bg">
      <img 
        src="https://www.moravian.edu/sites/default/files/2023-04/Florence%20Header.png" 
        alt="Tuscany Landscape Fallback" 
        class="fallback"
        onerror="this.src='https://via.placeholder.com/800x600?text=Tuscany+Image+Failed'"
      >
      <div class="centered-content">
        <h1>Italy 2025</h1>
        <div id="countdown">
          <span id="days">0</span> Days
        </div>
      </div>
    </div>

    <!-- Itinerary Grid -->
    <div class="max-w-4xl mx-auto p-4">
      <header class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-800">Choose an Itinerary</h2>
        <p class="text-gray-600 mt-2">Explore Chianti’s treasures</p>
      </header>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
        <div class="itinerary-tile" data-target="itinerary-section-greve">
          <h3 class="text-xl font-semibold text-gray-800">Greve</h3>
          <p class="text-gray-600">Discover Chianti’s heart from Il Cortile Pratolino</p>
        </div>
        <div class="itinerary-tile" data-target="itinerary-section-panzano">
          <h3 class="text-xl font-semibold text-gray-800">Panzano</h3>
          <p class="text-gray-600">Savor the charm of Panzano’s vineyards and cuisine</p>
        </div>
        <div class="itinerary-tile" data-target="itinerary-section-castellina">
          <h3 class="text-xl font-semibold text-gray-800">Castellina</h3>
          <p class="text-gray-600">Explore medieval Castellina’s history and views</p>
        </div>
        <div class="itinerary-tile" data-target="itinerary-section-montefioralle">
          <h3 class="text-xl font-semibold text-gray-800">Montefioralle</h3>
          <p class="text-gray-600">Wander the picturesque village of Montefioralle</p>
        </div>
      </div>

      <!-- Itinerary Sections (Hidden, used for modal content) -->
      <div id="itinerary-section-greve" class="hidden">
        <header class="text-center mb-8">
          <h2 class="text-3xl font-bold text-gray-800">Greve</h2>
          <p class="text-gray-600 mt-2">From Il Cortile Pratolino to Chianti’s Heart</p>
        </header>
        <div class="space-y-4">
          <div class="bg-white rounded-lg shadow-md">
            <button id="overview-panel-btn-greve" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Itinerary Overview</button>
            <div id="overview-panel-greve" class="panel-content p-4">
              <p class="text-gray-700"><strong>Start:</strong> Il Cortile Pratolino, near Montegonzi (9:30 AM)</p>
              <p class="text-gray-700"><strong>Destinations:</strong> Greve in Chianti, Montefioralle, Lamole, Panzano, Castellina in Chianti, Montegonzi</p>
              <p class="text-gray-700"><strong>End:</strong> Montegonzi (by 5:00 PM)</p>
              <p class="text-gray-700"><strong>Total Driving Distance:</strong> ~60 km</p>
              <p class="text-gray-700"><strong>Total Driving Time:</strong> ~1 hour 45 minutes</p>
              <p class="text-gray-700"><strong>Total Time:</strong> 7 hours 30 minutes (including activities and lunch)</p>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow-md">
            <button id="itinerary-panel-btn-greve" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Detailed Itinerary</button>
            <div id="itinerary-panel-greve" class="panel-content p-4">
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">9:30 AM – Depart to Greve in Chianti</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 15 km, ~20 minutes. From Il Cortile Pratolino, head south on local roads toward SP94. Turn right onto SP94, then left onto SR222 (Via Chiantigiana) toward Greve in Chianti. Follow SR222 for ~15 km. Park near Piazza Matteotti (try via Cesare Battisti for the large parking lot on via Rosa Libri).</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> The drive along SR222 offers rolling hills, vineyards, and cypress trees. Look for photo opportunities at vineyard viewpoints.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">9:50 AM – 10:50 AM: Greve in Chianti (1 hour)</h3>
                <p class="text-gray-700"><strong>Activities:</strong> Stroll Piazza Matteotti, the arcaded main square, with shops selling local wines, olive oil, and crafts. Admire the statue of explorer Giovanni da Verrazzano. Visit Antica Macelleria Falorni, a historic butcher shop since 1729, for a quick tasting of Tuscan cold cuts or to buy specialties. Pop into an enoteca like Enoteca Falorni for a quick Chianti Classico tasting (5-10 minutes, no reservation needed).</p>
                <p class="text-gray-700"><strong>Tips:</strong> Greve is Chianti’s commercial hub, so it’s lively but parking is straightforward outside the ZTL (Limited Traffic Zone). Avoid driving into the historic center.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">10:50 AM – Drive to Montefioralle</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 2 km, ~5 minutes. From Piazza Matteotti, take Via Roma west, following signs for Montefioralle. The road climbs uphill for ~2 km to the village. Park just outside the walls at Piazza Santo Stefano.</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> The short, winding road offers views of vineyards and the Greve valley.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">11:00 AM – 11:45 AM: Montefioralle (45 minutes)</h3>
                <p class="text-gray-700"><strong>Activities:</strong> Wander the narrow, cobbled streets of this tiny, fortified borgo, one of Italy’s most beautiful villages. See the Church of Santo Stefano and the house of Amerigo Vespucci (marked by a wasp coat of arms). Stop at Montefioralle Winery for a quick Chianti Classico or Vin Santo tasting (10 minutes, call ahead if possible: +39 055 853 189). Capture panoramic views of the surrounding vineyards and stone houses adorned with flowers.</p>
                <p class="text-gray-700"><strong>Tips:</strong> Montefioralle is compact, so 45 minutes is enough to explore. Avoid parking inside the village to save time.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">11:45 AM – Drive to Lamole</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 8 km, ~15 minutes. Return to Greve via the same road, then from Greve, follow SR222 south for ~1 km. Turn left onto Via Lamole (SP119), a narrow, winding road, and continue for ~7 km to Lamole. Park near Ristoro di Lamole (Via di Lamole, 6).</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> The road to Lamole is steep and curvy but stunning, with breathtaking views of Chianti Classico vineyards. Drive cautiously due to tight turns.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">12:15 PM – 1:45 PM: Lunch at Ristoro di Lamole (1 hour 30 minutes)</h3>
                <p class="text-gray-700"><strong>Activity:</strong> Enjoy lunch at Ristoro di Lamole, a trattoria with a panoramic terrace overlooking vineyards. Try seasonal pastas like tagliolini with truffles or Florentine steak. Pair with a glass of Chianti Classico. Reservations are recommended (+39 055 854 7050).</p>
                <p class="text-gray-700"><strong>Tips:</strong> The terrace is a highlight, so request an outdoor seat if weather permits. Keep lunch to 90 minutes to stay on schedule.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">1:45 PM – Drive to Panzano</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 6 km, ~10 minutes. Return down Via Lamole to SR222, turn left, and head south for ~6 km to Panzano. Park near the main square or Panzano Alto (upper village).</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> The SR222 stretch is very panoramic, with photo stops possible at vineyard pullouts.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">2:00 PM – 3:00 PM: Panzano (1 hour)</h3>
                <p class="text-gray-700"><strong>Activities:</strong> Visit Antica Macelleria Cecchini, Dario Cecchini’s famous butcher shop, for a quick tasting of Tuscan meats or to see his Dante-quoting showmanship (no reservation needed for the shop). Walk to Panzano Alto to see the Castle of Panzano’s remains and the Church of Santa Maria (rebuilt in the 19th century). Enjoy views from the small square. If time allows, take a 2-minute drive south to Pieve di San Leolino, a 10th-century Romanesque church with sacred artworks (5-minute visit).</p>
                <p class="text-gray-700"><strong>Tips:</strong> Panzano is small but charming. Focus on the butcher shop and a quick walk to stay on schedule.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">3:00 PM – Drive to Castellina in Chianti</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 15 km, ~20 minutes. Continue south on SR222 for ~15 km to Castellina in Chianti. Park near the main square or along Via IV Novembre.</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> This stretch of SR222 has tight curves but offers panoramic views of hills and vineyards.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">3:20 PM – 4:20 PM: Castellina in Chianti (1 hour)</h3>
                <p class="text-gray-700"><strong>Activities:</strong> Walk Via delle Volte, a romantic, medieval stone-vaulted passageway with shops and enotecas (10-minute stroll with valley views). Visit the main square’s Rocca Fortress, now home to the Archaeological Museum of Chianti Senese, and climb the tower for panoramic views (15 minutes, €5 entry). Grab a quick gelato at Gelateria Castellina with unique flavors like ricotta and fig or cantuccini and Vin Santo (5 minutes).</p>
                <p class="text-gray-700"><strong>Tips:</strong> Castellina is compact, so prioritize Via delle Volte and the fortress. Avoid lingering in shops to stay on time.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">4:20 PM – Drive to Montegonzi</h3>
                <p class="text-gray-700"><strong>Drive:</strong> 14 km, ~20 minutes. From Castellina, take SR222 north for ~5 km, then turn right onto SP99 toward Montegonzi. Follow SP99 for ~4 km to Montegonzi, then local roads to Il Cortile Pratolino.</p>
                <p class="text-gray-700"><strong>Scenic Notes:</strong> The route back passes through the Greve valley, with woodland paths and vineyard views.</p>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <h3 class="text-lg font-semibold text-gray-800">4:40 PM – Arrive in Montegonzi (by 5:00 PM)</h3>
                <p class="text-gray-700"><strong>Activity:</strong> Relax at Il Cortile Pratolino. If time permits, take a short walk in Montegonzi, a medieval settlement with historic stone buildings and valley views.</p>
                <p class="text-gray-700"><strong>Tips:</strong> Montegonzi is small, so no major activities are planned to ensure the itinerary ends by 5:00 PM.</p>
              </div>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow-md">
            <button id="time-panel-btn-greve" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Time Breakdown</button>
            <div id="time-panel-greve" class="panel-content p-4">
              <ul class="list-disc list-inside text-gray-700">
                <li>Driving: 1 hour 45 minutes</li>
                <li>Greve in Chianti: 1 hour</li>
                <li>Montefioralle: 45 minutes</li>
                <li>Lamole (Lunch): 1 hour 30 minutes</li>
                <li>Panzano: 1 hour</li>
                <li>Castellina in Chianti: 1 hour</li>
                <li>Buffer: 30 minutes (for traffic, photo stops, or delays)</li>
                <li><strong>Total:</strong> 7 hours 30 minutes (9:30 AM – 5:00 PM)</li>
              </ul>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow-md">
            <button id="tips-panel-btn-greve" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Additional Tips</button>
            <div id="tips-panel-greve" class="panel-content p-4">
              <ul class="list-disc list-inside text-gray-700">
                <li><strong>Driving:</strong> The SR222 and side roads are curvy; drive cautiously, especially on the narrow road to Lamole. A compact car is ideal.</li>
                <li><strong>Parking:</strong> Most towns have parking outside the ZTL zones. Greve and Castellina have larger lots; Montefioralle and Panzano have limited spaces.</li>
                <li><strong>What to Bring:</strong> Comfortable shoes for walking, a camera for scenic views, and cash for small shops or parking (some lots are coin-operated).</li>
                <li><strong>Reservations:</strong> Book Ristoro di Lamole in advance (+39 055 854 7050). For wine tastings, Montefioralle Winery may accept walk-ins, but calling ahead is safer (+39 055 853 189).</li>
                <li><strong>Seasonal Notes:</strong> In May, expect pleasant weather and blooming landscapes. Check for festivals like I Vini del Castello in Montefioralle (3rd weekend of May), which may affect parking.</li>
                <li><strong>Fuel:</strong> Fill up in Greve (Coop supermarket area on SR222 has gas stations) if needed.</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="itinerary-section-panzano" class="hidden">
          <header class="text-center mb-8">
            <h2 class="text-3xl font-bold text-gray-800">Panzano</h2>
            <p class="text-gray-600 mt-2">Savor the charm of Panzano’s vineyards and cuisine</p>
          </header>
          <div class="space-y-4">
            <div class="bg-white rounded-lg shadow-md">
              <button id="overview-panel-btn-panzano" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Itinerary Overview</button>
              <div id="overview-panel-panzano" class="panel-content p-4">
                <p class="text-gray-700"><strong>Start:</strong> Il Cortile Pratolino (9:00 AM)</p>
                <p class="text-gray-700"><strong>Destinations:</strong> Panzano, local vineyards, historic sites</p>
                <p class="text-gray-700"><strong>End:</strong> Il Cortile Pratolino (by 4:00 PM)</p>
                <p class="text-gray-700"><strong>Total Driving Distance:</strong> ~40 km</p>
                <p class="text-gray-700"><strong>Total Driving Time:</strong> ~1 hour</p>
                <p class="text-gray-700"><strong>Total Time:</strong> 7 hours (including activities and lunch)</p>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="itinerary-panel-btn-panzano" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Detailed Itinerary</button>
              <div id="itinerary-panel-panzano" class="panel-content p-4">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">9:00 AM – Depart to Panzano</h3>
                  <p class="text-gray-700"><strong>Drive:</strong> 20 km, ~30 minutes. Head south on SR222 to Panzano.</p>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">9:30 AM – 11:30 AM: Explore Panzano (2 hours)</h3>
                  <p class="text-gray-700"><strong>Activities:</strong> Visit local markets and enjoy a wine tasting at a nearby vineyard.</p>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="time-panel-btn-panzano" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Time Breakdown</button>
              <div id="time-panel-panzano" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li>Driving: 1 hour</li>
                  <li>Panzano Exploration: 2 hours</li>
                  <li>Lunch: 2 hours</li>
                  <li><strong>Total:</strong> 7 hours</li>
                </ul>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="tips-panel-btn-panzano" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Additional Tips</button>
              <div id="tips-panel-panzano" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li><strong>Driving:</strong> Watch for narrow roads.</li>
                  <li><strong>Parking:</strong> Use lots outside the town center.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div id="itinerary-section-castellina" class="hidden">
          <header class="text-center mb-8">
            <h2 class="text-3xl font-bold text-gray-800">Castellina</h2>
            <p class="text-gray-600 mt-2">Explore medieval Castellina’s history and views</p>
          </header>
          <div class="space-y-4">
            <div class="bg-white rounded-lg shadow-md">
              <button id="overview-panel-btn-castellina" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Itinerary Overview</button>
              <div id="overview-panel-castellina" class="panel-content p-4">
                <p class="text-gray-700"><strong>Start:</strong> Il Cortile Pratolino (8:30 AM)</p>
                <p class="text-gray-700"><strong>Destinations:</strong> Castellina, local museums, scenic viewpoints</p>
                <p class="text-gray-700"><strong>End:</strong> Il Cortile Pratolino (by 3:30 PM)</p>
                <p class="text-gray-700"><strong>Total Driving Distance:</strong> ~50 km</p>
                <p class="text-gray-700"><strong>Total Driving Time:</strong> ~1 hour 15 minutes</p>
                <p class="text-gray-700"><strong>Total Time:</strong> 7 hours (including activities and lunch)</p>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="itinerary-panel-btn-castellina" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Detailed Itinerary</button>
              <div id="itinerary-panel-castellina" class="panel-content p-4">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">8:30 AM – Depart to Castellina</h3>
                  <p class="text-gray-700"><strong>Drive:</strong> 25 km, ~35 minutes. Head south on SR222 to Castellina.</p>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">9:05 AM – 11:05 AM: Explore Castellina (2 hours)</h3>
                  <p class="text-gray-700"><strong>Activities:</strong> Visit the Rocca Fortress and enjoy a local museum tour.</p>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="time-panel-btn-castellina" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Time Breakdown</button>
              <div id="time-panel-castellina" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li>Driving: 1 hour 15 minutes</li>
                  <li>Castellina Exploration: 2 hours</li>
                  <li>Lunch: 2 hours</li>
                  <li><strong>Total:</strong> 7 hours</li>
                </ul>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="tips-panel-btn-castellina" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Additional Tips</button>
              <div id="tips-panel-castellina" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li><strong>Driving:</strong> Be cautious on curvy roads.</li>
                  <li><strong>Parking:</strong> Park near the main square.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div id="itinerary-section-montefioralle" class="hidden">
          <header class="text-center mb-8">
            <h2 class="text-3xl font-bold text-gray-800">Montefioralle</h2>
            <p class="text-gray-600 mt-2">Wander the picturesque village of Montefioralle</p>
          </header>
          <div class="space-y-4">
            <div class="bg-white rounded-lg shadow-md">
              <button id="overview-panel-btn-montefioralle" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Itinerary Overview</button>
              <div id="overview-panel-montefioralle" class="panel-content p-4">
                <p class="text-gray-700"><strong>Start:</strong> Il Cortile Pratolino (10:00 AM)</p>
                <p class="text-gray-700"><strong>Destinations:</strong> Montefioralle, local trails, wineries</p>
                <p class="text-gray-700"><strong>End:</strong> Il Cortile Pratolino (by 5:00 PM)</p>
                <p class="text-gray-700"><strong>Total Driving Distance:</strong> ~30 km</p>
                <p class="text-gray-700"><strong>Total Driving Time:</strong> ~45 minutes</p>
                <p class="text-gray-700"><strong>Total Time:</strong> 7 hours (including activities and lunch)</p>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="itinerary-panel-btn-montefioralle" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Detailed Itinerary</button>
              <div id="itinerary-panel-montefioralle" class="panel-content p-4">
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">10:00 AM – Depart to Montefioralle</h3>
                  <p class="text-gray-700"><strong>Drive:</strong> 15 km, ~20 minutes. Head west to Montefioralle.</p>
                </div>
                <div class="timeline-item">
                  <div class="timeline-dot"></div>
                  <h3 class="text-lg font-semibold text-gray-800">10:20 AM – 12:20 PM: Explore Montefioralle (2 hours)</h3>
                  <p class="text-gray-700"><strong>Activities:</strong> Stroll through the village and visit a local winery.</p>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="time-panel-btn-montefioralle" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Time Breakdown</button>
              <div id="time-panel-montefioralle" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li>Driving: 45 minutes</li>
                  <li>Montefioralle Exploration: 2 hours</li>
                  <li>Lunch: 2 hours</li>
                  <li><strong>Total:</strong> 7 hours</li>
                </ul>
              </div>
            </div>
            <div class="bg-white rounded-lg shadow-md">
              <button id="tips-panel-btn-montefioralle" class="w-full text-left p-4 text-lg font-semibold text-gray-800 bg-gray-50 hover:bg-gray-100 focus:outline-none">Additional Tips</button>
              <div id="tips-panel-montefioralle" class="panel-content p-4">
                <ul class="list-disc list-inside text-gray-700">
                  <li><strong>Driving:</strong> Narrow roads require careful driving.</li>
                  <li><strong>Parking:</strong> Limited spaces; park outside the village.</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Greve in Chianti Gallery -->
        <section class="my-8">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">Greve in Chianti Gallery</h2>
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
            <div>
              <img 
                src="https://images.pexels.com/photos/1285625/pexels-photo-1285625.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Piazza Matteotti in Greve" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Piazza Matteotti in Greve</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/135018/pexels-photo-135018.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Greve’s historic streets" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Greve’s historic streets</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/156321/pexels-photo-156321.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Vineyards near Greve" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Vineyards near Greve</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/747418/pexels-photo-747418.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Tuscan countryside near Greve" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Tuscan countryside near Greve</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/5409751/pexels-photo-5409751.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Greve valley landscape" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Greve valley landscape</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/2086030/pexels-photo-2086030.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Chianti vineyards near Greve" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Chianti vineyards near Greve</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/1269968/pexels-photo-1269968.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Greve’s rolling hills" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Greve’s rolling hills</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/20832069/pexels-photo-20832069.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Historic Greve village" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Historic Greve village</p>
            </div>
            <div>
              <img 
                src="https://images.pexels.com/photos/46148/pexels-photo-46148.jpeg?auto=compress&cs=tinysrgb&w=800" 
                alt="Tuscan stone buildings in Greve" 
                class="w-full h-48 object-cover rounded-lg shadow-md"
                onerror="this.src='https://via.placeholder.com/800x600?text=Greve+Image+Failed'"
              >
              <p class="text-sm text-gray-600 mt-2 text-center">Tuscan stone buildings in Greve</p>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div id="main-content" class="max-w-4xl mx-auto p-4 pt-20">
    <!-- Itineraries Tab -->
    <div id="itineraries-content" class="tab-content">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Itineraries</h1>
        <p class="text-gray-600 mt-2">View itineraries on the Home page</p>
      </header>
    </div>

    <!-- Gelato Game Tab (formerly Page 1) -->
    <div id="page1-content" class="tab-content">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Gelato Shop Dash</h1>
        <p class="text-gray-600 mt-2">Serve gelato orders before time runs out!</p>
      </header>
      <div class="bg-white p-6 rounded-lg shadow-md">
        <div class="flex flex-col items-center">
          <canvas id="game-canvas" width="300" height="200"></canvas>
          <div class="mt-4 flex flex-wrap justify-center">
            <button id="flavor-chocolate" class="game-button">Chocolate</button>
            <button id="flavor-vanilla" class="game-button">Vanilla</button>
            <button id="flavor-strawberry" class="game-button">Strawberry</button>
            <button id="topping-sprinkles" class="game-button">Sprinkles</button>
            <button id="topping-nuts" class="game-button">Nuts</button>
            <button id="topping-fruit" class="game-button">Fruit</button>
            <button id="serve-button" class="game-button mt-2">Serve</button>
            <button id="start-button" class="game-button mt-2">Start Game</button>
          </div>
          <p id="score-display" class="mt-4 text-lg font-semibold text-gray-800">Score: 0</p>
          <p id="timer-display" class="mt-2 text-lg font-semibold text-gray-800">Time: 60s</p>
          <p id="game-message" class="mt-2 text-lg text-gray-600"></p>
        </div>
      </div>
    </div>

    <!-- Page 2 Tab -->
    <div id="page2-content" class="tab-content">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Page 2</h1>
        <p class="text-gray-600 mt-2">Welcome to Page 2</p>
      </header>
      <div class="bg-white p-6 rounded-lg shadow-md">
        <p class="text-gray-700">This is a placeholder for Page 2 content. Add your details here.</p>
      </div>
    </div>

    <!-- Page 3 Tab -->
    <div id="page3-content" class="tab-content">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Page 3</h1>
        <p class="text-gray-600 mt-2">Welcome to Page 3</p>
      </header>
      <div class="bg-white p-6 rounded-lg shadow-md">
        <p class="text-gray-700">This is a placeholder for Page 3 content. Add your details here.</p>
      </div>
    </div>
  </div>

  <!-- Bottom Bar -->
  <div id="bottom-bar" class="hidden">Chianti 2025</div>

  <script>
    // Countdown Timer
    document.addEventListener('DOMContentLoaded', () => {
      const tripStart = new Date('2025-06-16T09:30:00+02:00').getTime();
      const updateCountdown = () => {
        const now = new Date().getTime();
        const distance = tripStart - now;
        if (distance < 0) {
          document.getElementById('countdown').innerHTML = 'Trip has started!';
          return;
        }
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        document.getElementById('days').textContent = days;
      };
      updateCountdown();
      setInterval(updateCountdown, 1000);

      // Navigation
      const navDropdown = document.getElementById('nav-dropdown');
      const homeBtn = document.getElementById('home-btn');
      const tabContents = document.querySelectorAll('.tab-content');
      const landingPage = document.getElementById('landing-page');
      const mainContent = document.getElementById('main-content');
      const modal = document.getElementById('itinerary-modal');
      const modalContentBody = document.getElementById('modal-content-body');
      const modalClose = document.getElementById('modal-close');

      function navigateTo(tab) {
        tabContents.forEach(c => c.classList.remove('active'));
        if (tab === 'landing') {
          landingPage.classList.add('active');
          mainContent.classList.add('hidden');
          navDropdown.value = 'landing';
          // Close modal if open
          modal.style.display = 'none';
          modalContentBody.innerHTML = '';
          // Reset game state when leaving Gelato Game
          resetGame();
        } else {
          landingPage.classList.remove('active');
          mainContent.classList.remove('hidden');
          document.getElementById(`${tab}-content`).classList.add('active');
          navDropdown.value = tab;
          // Close modal if open
          modal.style.display = 'none';
          modalContentBody.innerHTML = '';
          // Reset game state if navigating away from Gelato Game
          if (tab !== 'page1') {
            resetGame();
          }
        }
      }

      navDropdown.addEventListener('change', () => {
        navigateTo(navDropdown.value);
      });

      homeBtn.addEventListener('click', () => {
        navigateTo('landing');
      });

      // Bottom Bar Visibility
      const bottomBar = document.getElementById('bottom-bar');
      window.addEventListener('scroll', () => {
        if (window.innerHeight + Math.round(window.scrollY) >= document.body.offsetHeight) {
          bottomBar.classList.remove('hidden');
        } else {
          bottomBar.classList.add('hidden');
        }
      });

      // Itinerary Tile Navigation (Modal)
      const itineraryTiles = document.querySelectorAll('.itinerary-tile');
      itineraryTiles.forEach(tile => {
        tile.addEventListener('click', () => {
          const targetId = tile.getAttribute('data-target');
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            // Clone the section content to display in the modal
            const contentClone = targetSection.cloneNode(true);
            contentClone.classList.remove('hidden');
            modalContentBody.innerHTML = '';
            modalContentBody.appendChild(contentClone);
            modal.style.display = 'block';

            // Re-attach event listeners to cloned panel buttons
            const clonedPanelButtons = contentClone.querySelectorAll('[id$="-panel-btn-greve"], [id$="-panel-btn-panzano"], [id$="-panel-btn-castellina"], [id$="-panel-btn-montefioralle"]');
            clonedPanelButtons.forEach(button => {
              button.addEventListener('click', () => {
                const panelId = button.id.replace('-btn', '');
                const panel = contentClone.querySelector(`#${panelId}`);
                panel.classList.toggle('active');
              });
            });
          }
        });
      });

      // Modal Close
      modalClose.addEventListener('click', () => {
        modal.style.display = 'none';
        modalContentBody.innerHTML = '';
      });

      // Close modal on backdrop click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
          modalContentBody.innerHTML = '';
        }
      });

      // Gelato Game Logic
      const canvas = document.getElementById('game-canvas');
      const ctx = canvas.getContext('2d');
      const startButton = document.getElementById('start-button');
      const serveButton = document.getElementById('serve-button');
      const flavorButtons = {
        chocolate: document.getElementById('flavor-chocolate'),
        vanilla: document.getElementById('flavor-vanilla'),
        strawberry: document.getElementById('flavor-strawberry')
      };
      const toppingButtons = {
        sprinkles: document.getElementById('topping-sprinkles'),
        nuts: document.getElementById('topping-nuts'),
        fruit: document.getElementById('topping-fruit')
      };
      const scoreDisplay = document.getElementById('score-display');
      const timerDisplay = document.getElementById('timer-display');
      const gameMessage = document.getElementById('game-message');

      let gameState = {
        score: 0,
        timeLeft: 60,
        gameRunning: false,
        currentOrder: null,
        selectedFlavor: null,
        selectedTopping: null,
        intervalId: null
      };

      const flavors = ['Chocolate', 'Vanilla', 'Strawberry'];
      const toppings = ['Sprinkles', 'Nuts', 'Fruit'];
      const customers = ['👶', '👧', '👦', '👩', '👨'];

      function generateOrder() {
        const flavor = flavors[Math.floor(Math.random() * flavors.length)];
        const topping = toppings[Math.floor(Math.random() * toppings.length)];
        const customer = customers[Math.floor(Math.random() * customers.length)];
        return { flavor, topping, customer };
      }

      function drawGame() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw customer
        if (gameState.currentOrder) {
          ctx.font = '24px Arial';
          ctx.fillStyle = '#4a5568';
          ctx.textAlign = 'center';
          ctx.fillText(gameState.currentOrder.customer, 150, 50);

          // Draw speech bubble
          ctx.beginPath();
          ctx.fillStyle = '#fff';
          ctx.strokeStyle = '#4a5568';
          ctx.lineWidth = 2;
          ctx.roundRect(100, 60, 100, 40, 10);
          ctx.fill();
          ctx.stroke();

          // Draw order text
          ctx.font = '14px Arial';
          ctx.fillStyle = '#4a5568';
          ctx.fillText(`${gameState.currentOrder.flavor}`, 150, 80);
          ctx.fillText(`with ${gameState.currentOrder.topping}`, 150, 95);
        }

        // Draw selected gelato
        if (gameState.selectedFlavor) {
          ctx.beginPath();
          ctx.fillStyle = getFlavorColor(gameState.selectedFlavor);
          ctx.arc(150, 150, 20, 0, Math.PI * 2);
          ctx.fill();
        }
        if (gameState.selectedTopping) {
          ctx.font = '12px Arial';
          ctx.fillStyle = '#000';
          ctx.fillText(gameState.selectedTopping, 150, 180);
        }
      }

      function getFlavorColor(flavor) {
        switch (flavor) {
          case 'Chocolate': return '#8B4513';
          case 'Vanilla': return '#F3E5AB';
          case 'Strawberry': return '#FF6347';
          default: return '#FFFFFF';
        }
      }

      function startGame() {
        gameState.gameRunning = true;
        gameState.score = 0;
        gameState.timeLeft = 60;
        gameState.currentOrder = generateOrder();
        gameState.selectedFlavor = null;
        gameState.selectedTopping = null;
        scoreDisplay.textContent = `Score: ${gameState.score}`;
        timerDisplay.textContent = `Time: ${gameState.timeLeft}s`;
        gameMessage.textContent = '';
        startButton.disabled = true;
        serveButton.disabled = false;
        Object.values(flavorButtons).forEach(btn => btn.disabled = false);
        Object.values(toppingButtons).forEach(btn => btn.disabled = false);

        gameState.intervalId = setInterval(() => {
          gameState.timeLeft--;
          timerDisplay.textContent = `Time: ${gameState.timeLeft}s`;
          if (gameState.timeLeft <= 0) {
            endGame();
          }
        }, 1000);

        drawGame();
      }

      function endGame() {
        gameState.gameRunning = false;
        clearInterval(gameState.intervalId);
        gameMessage.textContent = `Game Over! Final Score: ${gameState.score}`;
        startButton.disabled = false;
        serveButton.disabled = true;
        Object.values(flavorButtons).forEach(btn => btn.disabled = true);
        Object.values(toppingButtons).forEach(btn => btn.disabled = true);
        gameState.currentOrder = null;
        drawGame();
      }

      function resetGame() {
        if (gameState.gameRunning) {
          clearInterval(gameState.intervalId);
        }
        gameState = {
          score: 0,
          timeLeft: 60,
          gameRunning: false,
          currentOrder: null,
          selectedFlavor: null,
          selectedTopping: null,
          intervalId: null
        };
        scoreDisplay.textContent = `Score: ${gameState.score}`;
        timerDisplay.textContent = `Time: ${gameState.timeLeft}s`;
        gameMessage.textContent = '';
        startButton.disabled = false;
        serveButton.disabled = true;
        Object.values(flavorButtons).forEach(btn => btn.disabled = true);
        Object.values(toppingButtons).forEach(btn => btn.disabled = true);
        drawGame();
      }

      function serveOrder() {
        if (!gameState.selectedFlavor || !gameState.selectedTopping) {
          gameMessage.textContent = 'Please select a flavor and topping!';
          return;
        }

        if (gameState.selectedFlavor === gameState.currentOrder.flavor &&
            gameState.selectedTopping === gameState.currentOrder.topping) {
          gameState.score += 10;
          gameMessage.textContent = 'Correct! +10 points';
        } else {
          gameState.score = Math.max(0, gameState.score - 5);
          gameMessage.textContent = 'Incorrect! -5 points';
        }

        scoreDisplay.textContent = `Score: ${gameState.score}`;
        gameState.currentOrder = generateOrder();
        gameState.selectedFlavor = null;
        gameState.selectedTopping = null;
        drawGame();
      }

      // Event Listeners for Game Buttons
      startButton.addEventListener('click', startGame);
      serveButton.addEventListener('click', serveOrder);

      Object.entries(flavorButtons).forEach(([flavor, button]) => {
        button.addEventListener('click', () => {
          gameState.selectedFlavor = flavor.charAt(0).toUpperCase() + flavor.slice(1);
          drawGame();
        });
      });

      Object.entries(toppingButtons).forEach(([topping, button]) => {
        button.addEventListener('click', () => {
          gameState.selectedTopping = topping.charAt(0).toUpperCase() + topping.slice(1);
          drawGame();
        });
      });

      // Initial draw
      drawGame();

      console.log('App loaded successfully');
    });
  </script>
</body>
</html>
